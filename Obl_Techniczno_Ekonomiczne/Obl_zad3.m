close all;
clc; 
clearvars;

%macierze admitancyjna obwodu 
Z10=1 - 2i;
Z12=0.5 + 1i;
Z13=2 + 4i;
Z30=0.5 - 3i;
Z34=1.5 + 2i;
Z40=2 - 3i;
Y=zeros(4,4);
K=zeros(6,5);
Y= [ 1/Z12+1/Z13+1/Z10 -1/Z12 -1/Z13 0
    1/-Z12 1/Z12 0 0
    -1/Z13 0 1/Z13+1/Z34+1/Z30 -1/Z34
    0 0 1/-Z34 1/Z40+1/Z34]
G=[(1/Z10) 0 0 0 0 0
    0 1/Z12 0 0 0 0 
    0 0 1/Z13 0 0 0 
    0 0 0 1/Z30 0 0
    0 0 0 0 1/Z34 0
    0 0 0 0 0 1/Z40];
K=[1 -1 0 0 0 
   0 1 -1 0 0
   0 -1 0 1 0
   1 0 0 -1 0
   0 0 0 1 -1
   1 0 0 0 -1];
KT=K'
Y0=K'*G*KT'
Y0(1,:)=[];
Y0(:,1)=[]
 

